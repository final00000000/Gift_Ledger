# 更新日志

本文档记录项目的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划中
- 深色模式支持
- 数据云同步

## [1.2.7] - 2026-02-06

### 新增
- ⚙️ **配置服务预加载**：SharedPreferences 一次性缓存，提供同步读取
- 🔓 **安全解锁统一入口**：无锁模式不弹 PIN，避免首次进入竞态
- 🔁 **版本同步工作流**：添加 GitHub Actions 自动同步版本号

### 优化
- 🌐 **Web 存储性能**：内存缓存 + 批量加载，减少序列化开销
- ⏱️ **配置读取性能**：减少重复异步读取开销
- 🏷️ **版本信息显示**：设置页版本号自动读取（避免手动维护）
- 🏠 **首页界面**：优化数据卡片和英雄区域布局
- 📊 **统计页面**：优化图表组件和数据展示
- 📋 **列表视图**：优化记录列表和时间线显示
- 🎨 **主题样式**：改进通用组件和主题配色
- 🔢 **PIN 码对话框**：增强交互体验和视觉效果
- 🌙 **农历工具**：增强农历日期计算和显示

### Android
- 🛡️ **混淆规则**：优化 ProGuard 配置
- 📦 **发布配置**：更新 AndroidManifest 配置
- 🖼️ **应用图标**：压缩优化 (346KB → 30KB)

### 文档
- 📝 精简 README 首页内容，新增功能特性文档
- 📚 新增英文构建指南 (BUILD_EN.md)
- 📋 更新 CHANGELOG 和发布说明

## [1.2.6] - 2026-01-30

### 新增
- 🔐 **密码找回功能**：设置密码时可自定义安全问题和答案
- 🔑 **忘记密码流程**：通过验证安全问题答案重置密码

### 优化
- 💊 **快捷操作 UI**：改为胶囊标签样式，与首页卡片风格统一
- ⌨️ **键盘适配**：优化弹窗在键盘弹起时的显示效果
- 🔒 **安全数据管理**：关闭安全锁时自动清除所有密码数据
- 🔄 **锁定状态隔离**：重置密码成功后自动清除锁定倒计时

### 修复
- 🐛 修复 SecurityService.dispose() 未调用 super.dispose() 警告

## [1.2.5] - 2026-01-29

### 新增
- 🔐 **安全功能**：PIN 码锁定保护敏感数据
- 👁️ **隐私保护**：金额隐藏功能，保护隐私
- 📱 **启动页优化**：全新启动页设计（Android）

### 优化
- ⚡ **状态管理重构**：使用 Provider + ChangeNotifier 实现响应式数据流
- 📦 **APK 大小优化**：启用代码压缩和混淆，预期减小 30-40%
- 🧹 **代码清理**：删除 6 个未使用的文件，提升代码库健康度
- 🔄 **自动刷新**：数据变化时自动更新 UI，无需手动刷新

### 修复
- 🐛 修复 SecurityService.isUnlocked 类型错误
- 🐛 修复 template_settings_screen 缺少 mounted 检查
- 🐛 修复 event_book_list_screen 和 guest_list_screen 监听器遗漏

### 文档
- 📚 新增 BUILD.md 构建指南（Android/Windows/Web/iOS）
- 📝 完善 README 目录导航
- 📋 更新 Release 说明

## [1.2.0] - 2026-01-15

### 新增
- 📚 活动簿功能：支持按活动（婚礼、满月酒等）管理礼金
- 📝 批量录入：在活动簿中快速批量添加多条记录
- 🔔 每月还礼提醒：自动推送待还人情 Top3

### 优化
- ⚡ 首页数据并行加载，速度提升 3-5 倍
- 📐 设置页布局压缩，更紧凑的视觉效果
- 🛡️ 批量录入输入验证（姓名限 20 字符，金额限数字）
- 🎨 活动簿卡片重设计，更精致的 UI

### 修复
- 🐛 修复活动簿点击崩溃问题
- 🐛 修复 EventBookCard 布局异常

## [1.0.1] - 2026-01-14

### 改进
- 📝 统一版本号至 1.0.1
- 📚 完善 iOS 自行构建说明（中英文）
- 📥 更新下载表格，添加详细说明和部署建议
- 🌐 添加 Web 部署指南（GitHub Pages、Vercel 等）

### 构建
- ✅ Android APK 构建完成 (55.1MB)
- ✅ Windows ZIP 构建完成 (13.4MB)
- ✅ Web ZIP 构建完成 (12MB)
- 📝 iOS 需自行构建（已提供详细步骤）

## [1.0.0] - 2026-01-13

### 新增
- 🎉 首次发布
- 📊 收支概览卡片，清晰展示收支对比
- 📝 快速记账功能，支持自定义金额输入
- 👥 联系人管理，自动维护礼金往来列表
- 🔍 搜索筛选功能，支持按姓名、事由快速查找
- ✏️ 记录编辑删除功能，点击记录即可修改或删除
- 📤 数据导出功能，支持 Excel 和 JSON 格式
- 📥 数据导入功能，支持从备份恢复数据
- 🛡️ 严格数据验证，防止重复导入
- 📱 响应式布局，适配不同屏幕尺寸
- 🎨 现代化 UI 设计，Material Design 3
- ⚡ 流畅的页面过渡动画
- 💾 SQLite 本地数据库存储
- 🔐 数据本地化，保护隐私

### 功能特性

#### 记录管理
- 支持婚礼、满月、乔迁、生日、丧事、过年等多种事由
- 关系标签：朋友、同事、亲戚、同学等
- 智能联系人建议，基于历史记录
- 备注功能，记录额外信息

#### 人际管理
- 清晰的收送记录追踪
- 还礼进度可视化
- 智能还礼状态标注（待还礼、已还礼、待收礼）
- 完整的历史往来记录

#### 数据管理
- Excel 导出/导入（支持自定义列顺序）
- JSON 格式备份
- 重复数据检测
- 数据完整性验证

### 技术栈
- Flutter 3.2.0+
- Dart 2.18.0+
- SQLite 数据库
- Material Design 3

### 支持平台
- ✅ Android (API 21+)
- ✅ iOS (14.0+)
- ✅ Web (现代浏览器)
- ✅ Windows (10+)

---

## 版本说明

### 语义化版本格式
- **主版本号（MAJOR）**: 不兼容的 API 修改
- **次版本号（MINOR）**: 向下兼容的功能性新增
- **修订号（PATCH）**: 向下兼容的问题修正

### 更新类型标签
- `新增`: 新功能
- `修复`: Bug 修复
- `改进`: 功能改进
- `优化`: 性能优化
- `变更`: API 或行为变更
- `移除`: 删除的功能
- `安全`: 安全相关修复
- `文档`: 文档更新
- `依赖`: 依赖项更新
